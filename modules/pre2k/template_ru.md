### Совместимость с Pre Windows 2000

**Уровень опасности:** [Средний]{.medium}

**Адрес:** 

**Описание:**

Обнаружено {{ total_found }} учетных записей с включённой совместимостью Pre-Windows 2000.

Когда в Active Directory создаётся учётная запись компьютера с включённой опцией совместимости с Pre-Windows 2000, ей назначается предсказуемый пароль по умолчанию — обычно это имя компьютера в нижнем регистре без символа «$» на конце. Злоумышленник, знающий или угадавший имя компьютера, может аутентифицироваться с использованием этого слабого пароля. Это может привести к несанкционированному доступу к домену, повышению привилегий и боковому перемещению в сети. Такие аккаунты часто не охватываются аудитами паролей, что делает их долгосрочной точкой риска.


| Компьютер      | Пароль       | Статус  |
|----------|----------|--------|
{% for computer in all_users %}| {{ computer.username }} | {{ computer.password }} | {{ "Активен" if computer.status else "Отключен" }} |
{% endfor %} 

**Рекомендации по устранению:**

- регулярно проводить аудит учётных записей компьютеров в Active Directory и удалять те, что не используются или были созданы для устаревших систем;
- использовать инструменты вроде [Pre2k](https://github.com/garrettfoster13/pre2k) или [NetExec (nxc)](https://github.com/NetExec-net/nxc) для выявления учётных записей с флагом `UserAccountControl = 4128` (PASSWD_NOTREQD | WORKSTATION_TRUST_ACCOUNT), что указывает на предсозданные аккаунты с предсказуемыми паролями;
- для всех выявленных аккаунтов задать уникальные и стойкие к перебору пароли;
- при создании новых учётных записей компьютеров не использовать опцию «Назначить эту учётную запись как компьютер Pre-Windows 2000», чтобы избежать автоматической генерации слабых паролей.
